from termcolor import colored

import os


def show_tree_view(startpath):
    print()
    print(colored("-----------------------------------------", "yellow"))

    print("\t\t " + colored("FILE STRUCTURE", "red", attrs=['bold', 'underline' ]))
    print(colored("-----------------------------------------", "yellow"))

    for root, dirs, files in os.walk(startpath):

        level = root.replace(startpath, '').count(os.sep) + 1

        indent = '_' * 4 * (level)
        print('{}{}/'.format(colored(indent, "blue"), os.path.basename(root)))

        subindent = ' ' * 4 * (level)
        subindent += "---| "
        for f in files:
            print('{}{}'.format(colored(subindent, "red"), f))


def deploy_checked_list(file_name):

    file = open(file_name, "r")
    attribute = []

    for att in file:

        att=att.strip()
        attribute.append(att)

    return attribute


def write_library_to_file(imported_library, output_name):

    output_file = open(output_name, "w")

    output_file.write(
        "\n\n**************************************************************************************************\n")
    output_file.write("\t\t\t\t\t\t| LIBRARY |"  + "\n")
    output_file.write(
        "**************************************************************************************************\n")
    print(
        colored("\n**************************************************************************************************",
                "cyan"))
    print(colored("\t\t\t\t\t\t| IMPORTED LIBRARY |", "red"))
    print(
        colored("**************************************************************************************************\n",
                "cyan"))

    for i in imported_library:
        output_file.write(i +"\n")
        print(colored(i,"green",attrs=["bold"]))
    output_file.close()


def determine_file_name(args):

    args_len = len(args)

    if args_len < 5:

        print("NEEDED FILE: malware_analysis.py - util.py - detection.py - wordlist - decompiler malware file")
        print("\t  ___________________________________________________________________________________________________________")
        print("\t|\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t|")
        print("\t| "+colored("WRONG USAGE !!!!!","red",attrs=["bold",'underline'])+"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t|")
        print("\t|\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t|")
        print("\t|"+colored("\t\tARGUMENT ORDER: ","yellow",attrs=["bold"])+colored("python3 malware_analysis <file name> <attribute> <output file> <library file>\t\t","cyan")+"|")
        print("\t|\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t|")
        print("\t|"+colored(" EXAMPLE: ","red")+colored("python3 malware_analysis.py ./sources  attribute.txt   output_file.txt  malware_library.txt\t\t\t|"))
        print("\t| __________________________________________________________________________________________________________|")
        os._exit(0)
